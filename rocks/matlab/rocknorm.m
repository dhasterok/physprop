close all;
clear all;

m = [32.2  34.5  26.9  19.9   0.5  44.2  36.0  25.8  21.6   7.4   2.0   3.0   1.4   16.7  30.4  24.7    % Quartz
     17.6  18.8  11.2  14.5  25.1  33.1  34.0  35.7  36.6  37.0  27.5  33.6  22.0   29.9  25.7   3.4    % Plagioclase 
     42.7  32.0  50.7  47.6  57.0   9.2   5.0   7.3  12.6   2.0   9.6   5.9   1.4   20.6  28.8  58.3    % K-feldspar 
      1.0  11.7   7.2   7.5  15.5   4.5   6.6  18.2  22.8  36.0   4.2  54.0  21.0    0.9   0.0   0.0    % Pyroxene 
      0.0   0.0   0.0   2.4   0.0   8.4   9.0   7.0   0.2  12.0   9.0   0.0  29.2    0.0   7.0  11.0    % Garnet 
      0.0   0.0   1.2   0.0   0.0   0.0   0.0   0.0   0.4   0.0  46.5   0.4   0.0   27.0   0.0   0.0    % Amphibole 
      5.5   0.0   0.0   1.4   0.4   0.0  13.4   4.0   3.4   1.0   0.0   0.4  24.0    5.9   7.2   8.6    % Biotite 
      1.0   3.0   2.3   6.7   1.5   0.6   6.0   2.0   2.4   4.6   1.2   3.0   1.0    4.9   0.9   4.0];  % Others

ox = [72.43 69.50 67.89 63.83 59.42 70.66 69.85 65.20 63.09 57.78 55.83 50.82 46.97  55.73 68.82 63.94  % SiO2 
       0.31  0.45  0.59  0.72  0.95  0.42  0.48  0.63  0.80  1.15  0.59  0.75  0.80   0.67  0.44  0.69  % TiO2 
      14.37 14.75 14.49 15.24 18.80 12.74 13.85 14.84 16.52 15.82 13.24 14.69 16.31  20.24 16.92 16.01  % Al2O3 
       2.38  3.61  4.37  6.12  4.02  5.77  5.08  5.65  5.92 11.23 11.18 11.54 12.71   5.03  2.49  4.98  % Fe2O3 
       0.02  0.04  0.06  0.10  0.08  0.10  0.06  0.06  0.06  0.16  0.20  0.18  0.19   0.06  0.01  0.06  % MnO 
       0.73  0.70  0.58  0.45  1.30  2.24  2.24  2.37  1.90  5.27  6.36  6.32  8.09   2.76  0.94  1.20  % MgO 
       2.65  2.83  2.60  2.53  3.09  3.76  2.84  4.33  4.44  3.45  9.56 11.22 11.40   7.07  3.12  1.87  % CaO 
       3.53  3.98  3.57  3.16  3.51  2.66  3.22  3.87  3.90  3.82  1.82  3.14  1.94   5.61  4.73  1.93  % Na2O 
       2.90  2.76  4.43  5.96  6.67  0.37  1.37  0.95  1.98  1.02  0.21  0.51  0.51   1.14  1.66  7.49  % K2O 
       0.05  0.14  0.19  0.16  0.26  0.12  0.10  0.21  0.28  0.02  0.07  0.07  0.06   0.22  0.07  0.55];% P2O5

[nm,nr] = size(m);
[nox,nr] = size(ox);
mlab = {'qz';'plag';'K-spar';'pyx';'gt';'am';'bt';'other'};
oxlab = {'SiO2';'TiO2';'Al2O3';'Fe2O3';'MnO';'MgO';'CaO';'Na2O';'K2O';'P2O5'};

for i = 1:nm
    figure;
    for j = 1:nox
        subplot(2,5,j);
        plot(m(i,:),ox(j,:),'*');
        xlabel(mlab{i});
        ylabel(oxlab{j});
    end
end

figure;
subplot(221);
plot(m(2,:),sum(ox(8:9,:)),'*');
xlabel('plag');
ylabel('NaO + KO');

subplot(222);
plot(m(2,:),ox(7,:),'*');
xlabel('plag');
ylabel('CaO');

subplot(223);
plot(m(3,:),sum(ox(8:9,:)),'*');
xlabel('K-spar');
ylabel('NaO + KO');

subplot(224);
plot(sum(m(2:3,:)),sum(ox(7:9,:)),'*');
xlabel('K-spar + plag');
ylabel('CaO + NaO + KO');

figure;
plot(m(3,:)./sum(m(2:3,:)),ox(7,:)./sum(ox(7:9,:)),'*');
