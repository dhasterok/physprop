close all;
clear all;

% Sample 1 - BALM4 from Gibert et al. [JGR, 2003]
% -----------------------------------------------------------------
% BALM1-X1
sample{2}.data{1} = [303  1.34;  323  1.26;  355  1.17;  389  1.08;  430  0.99;
     471  0.93;  523  0.87;  571  0.82;  620  0.76;  672  0.73;
     722  0.69;  723  0.70;  772  0.68;  823  0.66;  870  0.65;
     919  0.65;  967  0.63; 1015  0.60; 1064  0.59; 1110  0.59;
    1156  0.58; 1200  0.57];
% BALM1-Y1
sample{2}.data{2} = [295  1.31;  320  1.20;  353  1.11;  389  1.01;  428  0.93;
     472  0.86;  521  0.80;  571  0.74;  623  0.70;  671  0.67;
     721  0.64;  773  0.62;  822  0.61;  869  0.60;  919  0.59;
     969  0.57; 1017  0.55; 1067  0.55; 1111  0.54; 1155  0.53];
% BALM1-Z1
sample{2}.data{3} = [300  1.21;  321  1.12;  352  1.03;  387  0.95;  427  0.88;
     472  0.81;  519  0.75;  568  0.69;  618  0.65;  669  0.62;
     719  0.59;  769  0.59;  819  0.57;  867  0.56;  914  0.54;
     964  0.53; 1014  0.52; 1060  0.51; 1108  0.50];
  

% Sample 2 - BALM1 from Tommasi et al. [Nature, 2001]
% -----------------------------------------------------------------
% BALM4
sample{1}.data{1} = [294  1.39;  319  1.28;  321  1.26;  351  1.17;  385  1.10;  398  1.08;
    428  1.01;  461  0.94;  466  0.92;  518  0.87;  566  0.83;  573  0.81;
    622  0.78;  620  0.76;  667  0.74;  677  0.73;  719  0.72;  728  0.69;
    771  0.70;  776  0.68;  821  0.68;  824  0.66;  867  0.68;  869  0.66;
    919  0.67;  970  0.65; 1014  0.61; 1066  0.60; 1108  0.60; 1113  0.60;
   1156  0.59; 1201  0.58; 1199  0.57; 1246  0.57];
%% BALM4-X1
%sample{1}.data{1} = [298  1.39;  322  1.28;  326  1.26;  354  1.18;  389  1.10;
%     403  1.09;  432  1.01;  465  0.95;  469  0.93;  521  0.87;
%     571  0.83;  574  0.81;  622  0.78;  622  0.76;  666  0.74;
%     680  0.73;  719  0.72;  727  0.70;  773  0.70;  778  0.68;
%     824  0.68;  826  0.66;  870  0.68;  870  0.66;  920  0.67;
%     968  0.65; 1016  0.62; 1064  0.60; 1107  0.60; 1113  0.61;
%    1156  0.59; 1198  0.57; 1200  0.58; 1244  0.57];
%% BALM4-Z3
%sample{1}.data{2} = [297  1.11;  297  1.11;  297  1.10;  321  1.02;  330  1.02;
%     352  0.95;  359  0.95;  386  0.88;  398  0.87;  427  0.81;
%     427  0.80;  441  0.80;  464  0.75;  472  0.74;  521  0.68;
%     526  0.67;  563  0.64;  572  0.64;  572  0.62;  618  0.60;
%     625  0.59;  630  0.58;  666  0.56;  675  0.56;  721  0.54;
%     769  0.52;  775  0.52;  819  0.52;  818  0.51;  827  0.50;
%     867  0.50;  873  0.50;  914  0.49;  923  0.50;  965  0.49;
%     973  0.49; 1016  0.46; 1018  0.47; 1062  0.46; 1069  0.46];


% Sample 3 - PNG from Gibert et al. [JGR, 2003]
% -----------------------------------------------------------------
% PNG
sample{3}.data{1} = [294  1.50;  295  1.48;  313  1.39;  319  1.38;  326  1.36;
     351  1.25;  381  1.17;  391  1.15;  426  1.06;  431  1.05;
     467  0.99;  469  0.98;  470  0.98;  516  0.92;  526  0.91;
     566  0.87;  575  0.85;  613  0.81;  618  0.82;  666  0.78;
     672  0.77;  716  0.76;  724  0.74;  765  0.75;  775  0.73;
     821  0.73;  820  0.72;  870  0.71;  873  0.69;  918  0.70;
     918  0.69;  966  0.67; 1012  0.66; 1020  0.65; 1060  0.64;
    1064  0.66; 1111  0.64];

d = load('../files/balm.out');
ind = find(isnan(d(:,1)) == 1);
ind = [0; ind];
Tax = [200 1400];
dax = [0 2];
kax = [0 7];
for i = 2:length(ind)
    lo = ind(i-1)+1;
    hi = ind(i)-1;

    T = d(lo:hi,2);
    rho = d(lo:hi,4);
    cp = d(lo:hi,5);
    k = d(lo:hi,6);
    kappa = d(lo:hi,7);

    % diffusivity figure
    figure(1);
    subplot(2,2,i-1); hold on;
    for j = 1:length(sample{i-1}.data)
        plot(sample{i-1}.data{j}(:,1),sample{i-1}.data{j}(:,2),'kx');
    end
    plot(T,kappa*1e6,'r-');

    xlabel('T [K]');
    ylabel('\kappa [mm^2/s]');
    axis([Tax dax]);
    set(gca,'Box','on');


    % conductivity figure
    figure(2);

    subplot(2,2,i-1); hold on;
    for j = 1:length(sample{i-1}.data)
        Rho = interp1(T,rho,sample{i-1}.data{j}(:,1));
        Cp = interp1(T,cp,sample{i-1}.data{j}(:,1));

        plot(sample{i-1}.data{j}(:,1),sample{i-1}.data{j}(:,2)*1e-6.*Rho.*Cp,'kx');
    end
    plot(T,k,'r-');

    xlabel('T [K]');
    ylabel('k [W/m/K]');
    axis([Tax kax]);
    set(gca,'Box','on');
end
